<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŒ‚æœºæ¸¸æˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 400px;
            width: 100%;
            text-align: center;
        }

        .avatar-panel {
            background: linear-gradient(145deg, #f0f0f0, #ffffff);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 5px 5px 15px #d9d9d9, -5px -5px 15px #ffffff;
        }

        .avatar {
            font-size: 100px;
            margin-bottom: 15px;
            display: inline-block;
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .level-display {
            font-size: 28px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .level-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 20px;
        }

        .stats-panel {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .stat-item {
            margin-bottom: 12px;
            text-align: left;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }

        .stat-value.highlight {
            color: #667eea;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .exp-rate {
            color: #4CAF50;
            font-size: 14px;
            margin-top: 8px;
        }

        .level-up-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #ffd700 0%, #ffaa00 100%);
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            animation: slideDown 0.5s ease, fadeOut 0.5s ease 2s forwards;
            z-index: 1000;
        }

        @keyframes slideDown {
            from {
                top: -50px;
                opacity: 0;
            }
            to {
                top: 20px;
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        .exp-gain {
            position: absolute;
            font-size: 20px;
            font-weight: bold;
            color: #4CAF50;
            pointer-events: none;
            animation: floatUp 1s ease-out forwards;
        }

        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-50px);
            }
        }

        .buttons-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .game-btn {
            flex: 1;
            min-width: 100px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 20px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            position: relative;
        }

        .game-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .game-btn:active {
            transform: translateY(0);
        }

        .game-btn:disabled {
            background: #cccccc;
            box-shadow: none;
            cursor: not-allowed;
            transform: none;
        }

        .game-btn:disabled:hover {
            transform: none;
        }

        .level-up-btn {
            background: linear-gradient(135deg, #ffd700 0%, #ffaa00 100%);
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
        }

        .level-up-btn:hover {
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.6);
        }

        .insufficient-exp-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            animation: slideDown 0.5s ease, fadeOut 0.5s ease 1.5s forwards;
            z-index: 1000;
        }

        .debug-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 2000;
        }

        .reset-btn {
            background: #666;
            color: white;
            border: none;
            padding: 8px 16px;
            font-size: 12px;
            border-radius: 5px;
            cursor: pointer;
            opacity: 0.7;
        }

        .reset-btn:hover {
            opacity: 1;
        }

        .scene-switch-btn {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.4);
        }

        .scene-switch-btn:hover {
            box-shadow: 0 6px 20px rgba(33, 150, 243, 0.6);
        }

        .backpack-btn {
            background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.4);
        }

        .backpack-btn:hover {
            box-shadow: 0 6px 20px rgba(255, 152, 0, 0.6);
        }

        .backpack-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3000;
        }

        .backpack-panel.active {
            display: flex;
        }

        .backpack-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
        }

        .backpack-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .backpack-header h2 {
            color: #333;
            margin: 0;
        }

        .backpack-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
        }

        .backpack-slot {
            aspect-ratio: 1;
            background: linear-gradient(145deg, #f0f0f0, #ffffff);
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 40px;
            box-shadow: inset 2px 2px 5px #d9d9d9, inset -2px -2px 5px #ffffff;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .backpack-slot:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .backpack-slot.empty {
            color: #cccccc;
            font-size: 24px;
        }

        .backpack-slot.locked {
            background: linear-gradient(145deg, #e0e0e0, #f0f0f0);
            cursor: not-allowed;
            position: relative;
            overflow: hidden;
        }

        .backpack-slot.locked::before {
            content: 'ğŸ”’';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 30px;
            opacity: 0.5;
        }

        .backpack-slot .unlock-level {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            color: #666;
            white-space: nowrap;
        }

        .backpack-slot .unlock-level::before {
            content: 'Lv.';
            font-size: 8px;
        }

        .backpack-slot .item-count {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 10px;
        }

        .scene-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3000;
        }

        .scene-panel.active {
            display: flex;
        }

        .scene-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .scene-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .scene-header h2 {
            color: #333;
            margin: 0;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 5px 10px;
            border-radius: 5px;
        }

        .close-btn:hover {
            background: #f0f0f0;
        }

        .scene-list {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .scene-item {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .scene-item:hover:not(.locked) {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
        }

        .scene-item.active {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .scene-item.active .scene-emoji,
        .scene-item.active .scene-name,
        .scene-item.active .scene-rate {
            color: white;
        }

        .scene-item.locked {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .scene-emoji {
            font-size: 40px;
            margin-bottom: 8px;
        }

        .scene-name {
            font-size: 12px;
            color: #333;
            font-weight: bold;
            margin-bottom: 5px;
            word-break: break-all;
        }

        .scene-rate {
            font-size: 11px;
            color: #666;
        }

        .scene-locked-text {
            font-size: 12px;
            color: #999;
            margin-top: 5px;
        }

        .scene-unlock-badge {
            background: #ffd700;
            color: #333;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            margin-top: 5px;
            display: inline-block;
        }

        .current-scene-info {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .current-scene-info .scene-label {
            color: #1976D2;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .current-scene-info .scene-value {
            font-size: 20px;
            font-weight: bold;
            color: #1976D2;
        }

        .locked-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            animation: slideDown 0.5s ease, fadeOut 0.5s ease 1.5s forwards;
            z-index: 1000;
        }

        .item-tooltip {
            position: fixed;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            pointer-events: none;
            z-index: 4000;
            white-space: nowrap;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .item-tooltip .item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .item-tooltip .item-description {
            font-size: 12px;
            color: #ccc;
        }

        .item-tooltip .item-effect {
            font-size: 12px;
            color: #4CAF50;
            margin-top: 3px;
        }

        .backpack-slot.clickable {
            cursor: pointer;
            border: 2px solid transparent;
        }

        .backpack-slot.clickable:hover {
            border-color: #667eea;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.5);
        }

        .item-drop-animation {
            position: fixed;
            font-size: 30px;
            pointer-events: none;
            z-index: 5000;
            animation: dropToBackpack 1.5s ease-in-out forwards;
        }

        @keyframes dropToBackpack {
            0% {
                opacity: 1;
                transform: translate(0, 0) scale(1);
            }
            50% {
                transform: translate(var(--mid-x), var(--mid-y)) scale(1.2);
            }
            100% {
                opacity: 0;
                transform: translate(var(--target-x), var(--target-y)) scale(0.8);
            }
        }

        .drop-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            z-index: 5000;
            animation: dropNotificationPop 2s ease-out forwards;
        }

        @keyframes dropNotificationPop {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.1);
            }
            40% {
                transform: translate(-50%, -50%) scale(1);
            }
            80% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
        }

        .backpack-full-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            z-index: 5000;
            animation: dropNotificationPop 2s ease-out forwards;
        }

        .attributes-btn {
            background: linear-gradient(135deg, #9c27b0 0%, #673ab7 100%);
            box-shadow: 0 4px 15px rgba(156, 39, 176, 0.4);
        }

        .attributes-btn:hover {
            box-shadow: 0 6px 20px rgba(156, 39, 176, 0.6);
        }

        .attributes-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3500;
        }

        .attributes-panel.active {
            display: flex;
        }

        .attributes-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .attributes-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .attributes-header h2 {
            color: #333;
            margin: 0;
            font-size: 24px;
        }

        .attributes-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .attribute-item {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            border-left: 5px solid;
            transition: transform 0.2s ease;
        }

        .attribute-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .attribute-name {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .attribute-value {
            font-size: 24px;
            font-weight: bold;
        }

        .attribute-growth {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        /* å±æ€§é¢œè‰²ä¸»é¢˜ */
        .attribute-health { border-left-color: #f44336; background: linear-gradient(145deg, #ffebee, #ffffff); }
        .attribute-health .attribute-name { color: #d32f2f; }

        .attribute-mana { border-left-color: #2196f3; background: linear-gradient(145deg, #e3f2fd, #ffffff); }
        .attribute-mana .attribute-name { color: #1976d2; }

        .attribute-attack { border-left-color: #ff9800; background: linear-gradient(145deg, #fff3e0, #ffffff); }
        .attribute-attack .attribute-name { color: #f57c00; }

        .attribute-defense { border-left-color: #4caf50; background: linear-gradient(145deg, #e8f5e8, #ffffff); }
        .attribute-defense .attribute-name { color: #388e3c; }

        .attribute-accuracy { border-left-color: #00bcd4; background: linear-gradient(145deg, #e0f7fa, #ffffff); }
        .attribute-accuracy .attribute-name { color: #0097a7; }

        .attribute-evasion { border-left-color: #9c27b0; background: linear-gradient(145deg, #f3e5f5, #ffffff); }
        .attribute-evasion .attribute-name { color: #7b1fa2; }

        .attribute-crit { border-left-color: #e91e63; background: linear-gradient(145deg, #fce4ec, #ffffff); }
        .attribute-crit .attribute-name { color: #c2185b; }

        .attribute-crit-def { border-left-color: #607d8b; background: linear-gradient(145deg, #eceff1, #ffffff); }
        .attribute-crit-def .attribute-name { color: #455a64; }

        .attribute-icon {
            font-size: 20px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 5px 10px;
            border-radius: 5px;
            transition: background-color 0.2s ease;
        }

        .close-btn:hover {
            background: #f0f0f0;
        }
    </style>
</head>
<body>
    <div class="debug-controls">
        <button class="reset-btn" id="reset-btn">é‡ç½®æ¸¸æˆ</button>
    </div>

    <div class="game-container">
        <div class="avatar-panel">
            <div class="avatar">ğŸ˜Š</div>
            <div class="level-display">
                <span class="level-badge">Lv. <span id="level">1</span></span>
            </div>
        </div>

        <div class="stats-panel">
            <div class="stat-item">
                <div class="stat-label">å½“å‰åœºæ™¯</div>
                <div class="current-scene-info">
                    <div class="scene-label">åœºæ™¯</div>
                    <div class="scene-value"><span id="current-scene-emoji">ğŸ˜Š</span> <span id="current-scene-name">åˆå¿ƒä¹‹åœ°</span></div>
                </div>
            </div>

            <div class="stat-item">
                <div class="stat-label">å½“å‰ç»éªŒ</div>
                <div class="stat-value highlight"><span id="current-exp">0</span> / <span id="next-level-exp">100</span></div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                </div>
            </div>

            <div class="stat-item">
                <div class="stat-label">ç»éªŒè·å–é€Ÿç‡</div>
                <div class="stat-value"><span id="exp-rate">1</span> ç»éªŒ/ç§’</div>
            </div>
        </div>

        <div class="buttons-container">
            <button class="game-btn" id="gain-exp-btn" style="position: relative;">
                è·å¾—ç»éªŒ
            </button>
            <button class="game-btn level-up-btn" id="level-up-btn">
                å‡çº§
            </button>
            <button class="game-btn scene-switch-btn" id="scene-switch-btn">
                åœºæ™¯åˆ‡æ¢
            </button>
            <button class="game-btn backpack-btn" id="backpack-btn">
                èƒŒåŒ…
            </button>
            <button class="game-btn attributes-btn" id="attributes-btn" disabled>
                å±æ€§
            </button>
        </div>
    </div>

    <div class="backpack-panel" id="backpack-panel">
        <div class="backpack-content">
            <div class="backpack-header">
                <h2>èƒŒåŒ…</h2>
                <button class="close-btn" id="close-backpack-btn">&times;</button>
            </div>
            <div class="backpack-grid" id="backpack-grid">
            </div>
        </div>
    </div>

    <div class="scene-panel" id="scene-panel">
        <div class="scene-content">
            <div class="scene-header">
                <h2>é€‰æ‹©åœºæ™¯</h2>
                <button class="close-btn" id="close-scene-btn">&times;</button>
            </div>
            <div class="scene-list" id="scene-list">
            </div>
        </div>
    </div>

    <div class="attributes-panel" id="attributes-panel">
        <div class="attributes-content">
            <div class="attributes-header">
                <h2>ç©å®¶å±æ€§</h2>
                <button class="close-btn" id="close-attributes-btn">&times;</button>
            </div>
            <div class="attributes-grid" id="attributes-grid">
            </div>
        </div>
    </div>

    <script>
        // åœºæ™¯æ•°æ®ï¼ˆ20ä¸ªåœºæ™¯ï¼Œæ¯5çº§è§£é”ä¸€ä¸ªï¼‰
        const scenes = [
            { id: 0, name: 'åˆå¿ƒä¹‹åœ°', emoji: 'ğŸ˜Š', expRate: 1, unlockLevel: 1 },
            { id: 1, name: 'é™è°§æ£®æ—', emoji: 'ğŸŒ²', expRate: 2, unlockLevel: 5 },
            { id: 2, name: 'é˜³å…‰æµ·æ»©', emoji: 'ğŸ–ï¸', expRate: 3, unlockLevel: 10 },
            { id: 3, name: 'é›ªå±±ä¹‹å·…', emoji: 'ğŸ”ï¸', expRate: 4, unlockLevel: 15 },
            { id: 4, name: 'ç¥ç§˜æ´ç©´', emoji: 'ğŸ•³ï¸', expRate: 5, unlockLevel: 20 },
            { id: 5, name: 'ç¹åéƒ½å¸‚', emoji: 'ğŸ™ï¸', expRate: 6, unlockLevel: 25 },
            { id: 6, name: 'æµ·åº•ä¸–ç•Œ', emoji: 'ğŸš', expRate: 7, unlockLevel: 30 },
            { id: 7, name: 'æ²™æ¼ ç»¿æ´²', emoji: 'ğŸŒ´', expRate: 8, unlockLevel: 35 },
            { id: 8, name: 'æ˜Ÿç©ºè‰åŸ', emoji: 'ğŸŒŒ', expRate: 9, unlockLevel: 40 },
            { id: 9, name: 'æ¨±èŠ±åº­é™¢', emoji: 'ğŸŒ¸', expRate: 10, unlockLevel: 45 },
            { id: 10, name: 'è¿œå¤é—è¿¹', emoji: 'ğŸ›ï¸', expRate: 12, unlockLevel: 50 },
            { id: 11, name: 'ç«å±±ç§˜å¢ƒ', emoji: 'ğŸŒ‹', expRate: 14, unlockLevel: 55 },
            { id: 12, name: 'å½©è™¹æ¡¥', emoji: 'ğŸŒˆ', expRate: 16, unlockLevel: 60 },
            { id: 13, name: 'äº‘ç«¯ä¹‹ä¸Š', emoji: 'â˜ï¸', expRate: 18, unlockLevel: 65 },
            { id: 14, name: 'æ°´æ™¶å®«æ®¿', emoji: 'ğŸ’', expRate: 20, unlockLevel: 70 },
            { id: 15, name: 'æå…‰å†°åŸ', emoji: 'âœ¨', expRate: 25, unlockLevel: 75 },
            { id: 16, name: 'é­”æ³•æ£®æ—', emoji: 'ğŸ”®', expRate: 30, unlockLevel: 80 },
            { id: 17, name: 'é¾™ä¹‹å·¢ç©´', emoji: 'ğŸ‰', expRate: 35, unlockLevel: 85 },
            { id: 18, name: 'å¤©ç•Œåœ£åŸŸ', emoji: 'â­', expRate: 40, unlockLevel: 90 },
            { id: 19, name: 'æ··æ²Œè™šç©º', emoji: 'ğŸŒ€', expRate: 50, unlockLevel: 95 }
        ];

        // åœºæ™¯æ‰è½æ•°æ®
        const sceneDrops = {
            0: [ // åˆå¿ƒä¹‹åœ° (Lv.1)
                { itemId: 'di_ling_dan', probability: 0.10 },
                { itemId: 'health_grass', probability: 0.005 },
                { itemId: 'mana_herb', probability: 0.005 }
            ],
            1: [ // é™è°§æ£®æ— (Lv.5)
                { itemId: 'di_ling_dan', probability: 0.08 },
                { itemId: 'tian_ling_dan', probability: 0.05 },
                { itemId: 'health_grass', probability: 0.008 },
                { itemId: 'mana_herb', probability: 0.008 },
                { itemId: 'attack_pearl', probability: 0.004 }
            ],
            2: [ // é˜³å…‰æµ·æ»© (Lv.10)
                { itemId: 'di_ling_dan', probability: 0.06 },
                { itemId: 'tian_ling_dan', probability: 0.06 },
                { itemId: 'xiao_huan_dan', probability: 0.04 },
                { itemId: 'mana_herb', probability: 0.006 },
                { itemId: 'attack_pearl', probability: 0.006 },
                { itemId: 'defense_scale', probability: 0.003 }
            ],
            3: [ // é›ªå±±ä¹‹å·… (Lv.15)
                { itemId: 'tian_ling_dan', probability: 0.07 },
                { itemId: 'xiao_huan_dan', probability: 0.05 },
                { itemId: 'da_huan_dan', probability: 0.03 },
                { itemId: 'health_essence', probability: 0.004 },
                { itemId: 'attack_pearl', probability: 0.005 },
                { itemId: 'defense_scale', probability: 0.005 },
                { itemId: 'accuracy_feather', probability: 0.003 }
            ],
            4: [ // ç¥ç§˜æ´ç©´ (Lv.20)
                { itemId: 'xiao_huan_dan', probability: 0.06 },
                { itemId: 'da_huan_dan', probability: 0.05 },
                { itemId: 'jiu_zhuan_hun_hun_dan', probability: 0.02 },
                { itemId: 'mana_essence', probability: 0.003 },
                { itemId: 'attack_stone', probability: 0.004 },
                { itemId: 'defense_scale', probability: 0.004 },
                { itemId: 'evasion_wind', probability: 0.003 },
                { itemId: 'crit_fang', probability: 0.002 }
            ],
            5: [ // ç¹åéƒ½å¸‚ (Lv.25)
                { itemId: 'da_huan_dan', probability: 0.06 },
                { itemId: 'jiu_zhuan_hun_hun_dan', probability: 0.04 },
                { itemId: 'xian_lu', probability: 0.03 },
                { itemId: 'health_essence', probability: 0.003 },
                { itemId: 'attack_stone', probability: 0.003 },
                { itemId: 'defense_essence', probability: 0.002 },
                { itemId: 'accuracy_feather', probability: 0.003 },
                { itemId: 'crit_fang', probability: 0.002 }
            ],
            6: [ // æµ·åº•ä¸–ç•Œ (Lv.30)
                { itemId: 'jiu_zhuan_hun_hun_dan', probability: 0.05 },
                { itemId: 'xian_lu', probability: 0.05 },
                { itemId: 'shen_dan', probability: 0.02 },
                { itemId: 'tai_ji_dan', probability: 0.01 },
                { itemId: 'health_crystal', probability: 0.002 },
                { itemId: 'mana_essence', probability: 0.002 },
                { itemId: 'attack_stone', probability: 0.003 },
                { itemId: 'crit_claw', probability: 0.002 },
                { itemId: 'crit_def_horn', probability: 0.001 }
            ],
            7: [ // æ²™æ¼ ç»¿æ´² (Lv.35)
                { itemId: 'xian_lu', probability: 0.06 },
                { itemId: 'shen_dan', probability: 0.04 },
                { itemId: 'tai_ji_dan', probability: 0.02 },
                { itemId: 'hun_dun_dan', probability: 0.01 },
                { itemId: 'mana_essence', probability: 0.002 },
                { itemId: 'attack_stone', probability: 0.002 },
                { itemId: 'defense_essence', probability: 0.002 },
                { itemId: 'evasion_shadow', probability: 0.002 },
                { itemId: 'crit_claw', probability: 0.002 },
                { itemId: 'crit_def_horn', probability: 0.001 }
            ],
            8: [ // æ˜Ÿç©ºè‰åŸ (Lv.40)
                { itemId: 'shen_dan', probability: 0.05 },
                { itemId: 'tai_ji_dan', probability: 0.03 },
                { itemId: 'hun_dun_dan', probability: 0.02 },
                { itemId: 'qian_kun_dan', probability: 0.01 },
                { itemId: 'mana_crystal', probability: 0.002 },
                { itemId: 'attack_crystal', probability: 0.002 },
                { itemId: 'defense_essence', probability: 0.002 },
                { itemId: 'accuracy_eye', probability: 0.002 },
                { itemId: 'evasion_shadow', probability: 0.002 },
                { itemId: 'crit_claw', probability: 0.001 }
            ],
            9: [ // æ¨±èŠ±åº­é™¢ (Lv.45)
                { itemId: 'tai_ji_dan', probability: 0.04 },
                { itemId: 'hun_dun_dan', probability: 0.03 },
                { itemId: 'qian_kun_dan', probability: 0.01 },
                { itemId: 'defense_crystal', probability: 0.001 },
                { itemId: 'accuracy_eye', probability: 0.002 },
                { itemId: 'evasion_crystal', probability: 0.001 },
                { itemId: 'crysta_crystal', probability: 0.001 }
            ],
            10: [ // è¿œå¤é—è¿¹ (Lv.50)
                { itemId: 'tai_ji_dan', probability: 0.05 },
                { itemId: 'hun_dun_dan', probability: 0.04 },
                { itemId: 'qian_kun_dan', probability: 0.02 },
                { itemId: 'health_crystal', probability: 0.001 },
                { itemId: 'attack_crystal', probability: 0.001 },
                { itemId: 'accuracy_eye', probability: 0.002 },
                { itemId: 'evasion_crystal', probability: 0.002 },
                { itemId: 'crysta_crystal', probability: 0.001 },
                { itemId: 'crit_def_shield', probability: 0.001 }
            ],
            11: [ // ç«å±±ç§˜å¢ƒ (Lv.55)
                { itemId: 'hun_dun_dan', probability: 0.05 },
                { itemId: 'qian_kun_dan', probability: 0.03 },
                { itemId: 'accuracy_crystal', probability: 0.001 },
                { itemId: 'crysta_crystal', probability: 0.002 },
                { itemId: 'crit_def_shield', probability: 0.001 }
            ],
            12: [ // å½©è™¹æ¡¥ (Lv.60)
                { itemId: 'hun_dun_dan', probability: 0.06 },
                { itemId: 'qian_kun_dan', probability: 0.04 },
                { itemId: 'accuracy_crystal', probability: 0.001 },
                { itemId: 'crit_def_crystal', probability: 0.001 }
            ],
            13: [ // äº‘ç«¯ä¹‹ä¸Š (Lv.65)
                { itemId: 'qian_kun_dan', probability: 0.05 },
                { itemId: 'crit_def_crystal', probability: 0.001 }
            ],
            14: [ // æ°´æ™¶å®«æ®¿ (Lv.70)
                { itemId: 'qian_kun_dan', probability: 0.06 },
                { itemId: 'crit_def_crystal', probability: 0.001 }
            ],
            15: [ // æå…‰å†°åŸ (Lv.75)
                { itemId: 'qian_kun_dan', probability: 0.07 },
                { itemId: 'crit_def_crystal', probability: 0.002 }
            ],
            16: [ // é­”æ³•æ£®æ— (Lv.80)
                { itemId: 'qian_kun_dan', probability: 0.08 },
                { itemId: 'crit_def_crystal', probability: 0.002 }
            ],
            17: [ // é¾™ä¹‹å·¢ç©´ (Lv.85)
                { itemId: 'qian_kun_dan', probability: 0.09 },
                { itemId: 'crit_def_crystal', probability: 0.003 }
            ],
            18: [ // å¤©ç•Œåœ£åŸŸ (Lv.90)
                { itemId: 'qian_kun_dan', probability: 0.10 },
                { itemId: 'crit_def_crystal', probability: 0.003 }
            ],
            19: [ // æ··æ²Œè™šç©º (Lv.95)
                { itemId: 'qian_kun_dan', probability: 0.12 },
                { itemId: 'crit_def_crystal', probability: 0.005 }
            ]
        };

        // ç‰©å“æ•°æ®
        const itemTypes = [
            // ç»éªŒä¸¹è¯
            { id: 'di_ling_dan', name: 'åœ°çµä¸¹', emoji: 'ğŸ’Š', description: 'è•´å«å¤§åœ°ç²¾åçš„ç¥ç§˜ä¸¹è¯', expValue: 100, requiredLevel: 1, type: 'exp' },
            { id: 'tian_ling_dan', name: 'å¤©çµä¸¹', emoji: 'âœ¨', description: 'è•´å«å¤©ç©ºç²¾åçš„ç¥ç§˜ä¸¹è¯', expValue: 1000, requiredLevel: 8, type: 'exp' },
            { id: 'xiao_huan_dan', name: 'å°è¿˜ä¸¹', emoji: 'ğŸ”®', description: 'è•´å«ç”Ÿå‘½ç²¾åçš„åˆçº§ä¸¹è¯', expValue: 2000, requiredLevel: 11, type: 'exp' },
            { id: 'da_huan_dan', name: 'å¤§è¿˜ä¸¹', emoji: 'ğŸ’', description: 'è•´å«ç”Ÿå‘½ç²¾åçš„ä¸­çº§ä¸¹è¯', expValue: 5000, requiredLevel: 14, type: 'exp' },
            { id: 'jiu_zhuan_hun_hun_dan', name: 'ä¹è½¬è¿˜é­‚ä¸¹', emoji: 'ğŸŒŸ', description: 'è•´å«ç”Ÿå‘½ç²¾åçš„é«˜çº§ä¸¹è¯', expValue: 20000, requiredLevel: 18, type: 'exp' },
            { id: 'xian_lu', name: 'ä»™éœ²', emoji: 'ğŸ’§', description: 'è•´å«ä»™æ°”çš„çè´µæ¶²ä½“', expValue: 30000, requiredLevel: 22, type: 'exp' },
            { id: 'shen_dan', name: 'ç¥ä¸¹', emoji: 'ğŸ”¥', description: 'è•´å«ç¥åŠ›çš„ç«ç„°ä¸¹è¯', expValue: 50000, requiredLevel: 26, type: 'exp' },
            { id: 'tai_ji_dan', name: 'å¤ªæä¸¹', emoji: 'â˜¯ï¸', description: 'è•´å«é˜´é˜³ä¹‹åŠ›çš„ç»ˆæä¸¹è¯', expValue: 80000, requiredLevel: 30, type: 'exp' },
            { id: 'hun_dun_dan', name: 'æ··æ²Œä¸¹', emoji: 'ğŸŒªï¸', description: 'è•´å«æ··æ²Œèƒ½é‡çš„ç¥ç§˜ä¸¹è¯', expValue: 100000, requiredLevel: 35, type: 'exp' },
            { id: 'qian_kun_dan', name: 'ä¹¾å¤ä¸¹', emoji: 'ğŸŒŒ', description: 'è•´å«å®‡å®™ä¹‹å®çš„è‡³å°Šä¸¹è¯', expValue: 150000, requiredLevel: 40, type: 'exp' },

            // ç”Ÿå‘½å±æ€§ç‰©å“
            { id: 'health_grass', name: 'è¿˜é­‚è‰', emoji: 'ğŸŒ¿', description: 'ç¥å¥‡çš„ä»™è‰ï¼Œæœç”¨åæ°¸ä¹…æå‡ç”Ÿå‘½ä¸Šé™', statType: 'health', statValue: 5, requiredLevel: 5, type: 'stat' },
            { id: 'health_essence', name: 'ç”Ÿå‘½ç²¾é­„', emoji: 'ğŸ’š', description: 'å‡èšçš„ç”Ÿå‘½ç²¾åï¼Œå¤§å¹…æå‡ç”Ÿå‘½ä¸Šé™', statType: 'health', statValue: 15, requiredLevel: 15, type: 'stat' },
            { id: 'health_crystal', name: 'ç”Ÿå‘½æ°´æ™¶', emoji: 'ğŸ’', description: 'è•´å«çº¯ç²¹ç”Ÿå‘½èƒ½é‡çš„æ°´æ™¶ï¼Œæå¤§æå‡ç”Ÿå‘½ä¸Šé™', statType: 'health', statValue: 50, requiredLevel: 30, type: 'stat' },

            // å†…åŠ›å±æ€§ç‰©å“
            { id: 'mana_herb', name: 'çµæ°”è‰', emoji: 'ğŸŒ±', description: 'è•´å«çµæ°”çš„ä»™è‰ï¼Œæœç”¨åæ°¸ä¹…æå‡å†…åŠ›ä¸Šé™', statType: 'mana', statValue: 3, requiredLevel: 3, type: 'stat' },
            { id: 'mana_essence', name: 'å†…åŠ›ç²¾é­„', emoji: 'ğŸ’™', description: 'å‡èšçš„å†…åŠ›ç²¾åï¼Œå¤§å¹…æå‡å†…åŠ›ä¸Šé™', statType: 'mana', statValue: 10, requiredLevel: 12, type: 'stat' },
            { id: 'mana_crystal', name: 'å†…åŠ›æ°´æ™¶', emoji: 'ğŸ”®', description: 'è•´å«çº¯ç²¹å†…åŠ›èƒ½é‡çš„æ°´æ™¶ï¼Œæå¤§æå‡å†…åŠ›ä¸Šé™', statType: 'mana', statValue: 30, requiredLevel: 25, type: 'stat' },

            // æ”»å‡»å±æ€§ç‰©å“
            { id: 'attack_pearl', name: 'æ”»å‡»çç ', emoji: 'âšª', description: 'è•´å«æ”»å‡»åŠ›çš„ç¥å¥‡çç ï¼Œæ°¸ä¹…æå‡æ”»å‡»åŠ›', statType: 'attack', statValue: 2, requiredLevel: 4, type: 'stat' },
            { id: 'attack_stone', name: 'æ”»å‡»ä¹‹çŸ³', emoji: 'ğŸ—¿', description: 'å¤ä»£æˆ˜å£«çš„æ”»å‡»ä¹‹çŸ³ï¼Œå¤§å¹…æå‡æ”»å‡»åŠ›', statType: 'attack', statValue: 8, requiredLevel: 18, type: 'stat' },
            { id: 'attack_crystal', name: 'æ”»å‡»æ°´æ™¶', emoji: 'âš¡', description: 'è•´å«å¼ºå¤§æ”»å‡»èƒ½é‡çš„æ°´æ™¶ï¼Œæå¤§æå‡æ”»å‡»åŠ›', statType: 'attack', statValue: 25, requiredLevel: 35, type: 'stat' },

            // é˜²å¾¡å±æ€§ç‰©å“
            { id: 'defense_scale', name: 'é˜²å¾¡é³ç‰‡', emoji: 'ğŸ”¸', description: 'é¾™æ—çš„é˜²å¾¡é³ç‰‡ï¼Œæ°¸ä¹…æå‡é˜²å¾¡åŠ›', statType: 'defense', statValue: 1, requiredLevel: 6, type: 'stat' },
            { id: 'defense_essence', name: 'é˜²å¾¡ç²¾é­„', emoji: 'ğŸ›¡ï¸', description: 'å‡èšçš„é˜²å¾¡ç²¾åï¼Œå¤§å¹…æå‡é˜²å¾¡åŠ›', statType: 'defense', statValue: 5, requiredLevel: 20, type: 'stat' },
            { id: 'defense_crystal', name: 'é˜²å¾¡æ°´æ™¶', emoji: 'ğŸ’ ', description: 'è•´å«çº¯ç²¹é˜²å¾¡èƒ½é‡çš„æ°´æ™¶ï¼Œæå¤§æå‡é˜²å¾¡åŠ›', statType: 'defense', statValue: 20, requiredLevel: 40, type: 'stat' },

            // å‘½ä¸­å±æ€§ç‰©å“
            { id: 'accuracy_feather', name: 'å‘½ä¸­ç¾½æ¯›', emoji: 'ğŸª¶', description: 'è½»ç›ˆçš„é­”æ³•ç¾½æ¯›ï¼Œæ°¸ä¹…æå‡å‘½ä¸­ç‡', statType: 'accuracy', statValue: 3, requiredLevel: 8, type: 'stat' },
            { id: 'accuracy_eye', name: 'é¹°çœ¼çŸ³', emoji: 'ğŸ‘ï¸', description: 'è•´å«é¹°ä¹‹çœ¼åŠ›çš„å®çŸ³ï¼Œå¤§å¹…æå‡å‘½ä¸­ç‡', statType: 'accuracy', statValue: 10, requiredLevel: 22, type: 'stat' },
            { id: 'accuracy_crystal', name: 'å‘½ä¸­æ°´æ™¶', emoji: 'ğŸ¯', description: 'è•´å«ç²¾å‡†èƒ½é‡çš„æ°´æ™¶ï¼Œæå¤§æå‡å‘½ä¸­ç‡', statType: 'accuracy', statValue: 35, requiredLevel: 45, type: 'stat' },

            // é—ªé¿å±æ€§ç‰©å“
            { id: 'evasion_wind', name: 'é£ä¹‹æ¯', emoji: 'ğŸŒ¬ï¸', description: 'è•´å«é£ä¹‹ç²¾åçš„ç‰©å“ï¼Œæ°¸ä¹…æå‡é—ªé¿ç‡', statType: 'evasion', statValue: 2, requiredLevel: 7, type: 'stat' },
            { id: 'evasion_shadow', name: 'æš—å½±æ–—ç¯·', emoji: 'ğŸ¦‡', description: 'æš—å½±ç¼–ç»‡çš„æ–—ç¯·ï¼Œå¤§å¹…æå‡é—ªé¿ç‡', statType: 'evasion', statValue: 7, requiredLevel: 16, type: 'stat' },
            { id: 'evasion_crystal', name: 'é—ªé¿æ°´æ™¶', emoji: 'ğŸ’¨', description: 'è•´å«çµåŠ¨èƒ½é‡çš„æ°´æ™¶ï¼Œæå¤§æå‡é—ªé¿ç‡', statType: 'evasion', statValue: 25, requiredLevel: 38, type: 'stat' },

            // æš´å‡»å±æ€§ç‰©å“
            { id: 'crit_fang', name: 'æš´å‡»å°–ç‰™', emoji: 'ğŸ¦·', description: 'çŒ›å…½çš„å°–ç‰™ï¼Œæ°¸ä¹…æå‡æš´å‡»ç‡', statType: 'crit', statValue: 1, requiredLevel: 10, type: 'stat' },
            { id: 'crit_claw', name: 'æš´å‡»åˆ©çˆª', emoji: 'ğŸ¾', description: 'çŒ›å…½çš„åˆ©çˆªï¼Œå¤§å¹…æå‡æš´å‡»ç‡', statType: 'crit', statValue: 4, requiredLevel: 28, type: 'stat' },
            { id: 'crysta_crystal', name: 'æš´å‡»æ°´æ™¶', emoji: 'ğŸ’¥', description: 'è•´å«æš´å‡»èƒ½é‡çš„æ°´æ™¶ï¼Œæå¤§æå‡æš´å‡»ç‡', statType: 'crit', statValue: 15, requiredLevel: 50, type: 'stat' },

            // æš´å‡»é˜²å¾¡å±æ€§ç‰©å“
            { id: 'crit_def_horn', name: 'é˜²å¾¡å°–è§’', emoji: 'ğŸ¦', description: 'çŠ€ç‰›çš„é˜²å¾¡å°–è§’ï¼Œæ°¸ä¹…æå‡æš´å‡»é˜²å¾¡', statType: 'critDef', statValue: 1, requiredLevel: 12, type: 'stat' },
            { id: 'crit_def_shield', name: 'æš´å‡»æŠ¤ç›¾', emoji: 'ğŸ›¡ï¸', description: 'è•´å«é˜²å¾¡èƒ½é‡çš„æŠ¤ç›¾ï¼Œå¤§å¹…æå‡æš´å‡»é˜²å¾¡', statType: 'critDef', statValue: 3, requiredLevel: 32, type: 'stat' },
            { id: 'crit_def_crystal', name: 'é˜²å¾¡æ°´æ™¶', emoji: 'ğŸ”°', description: 'è•´å«åšéŸ§èƒ½é‡çš„æ°´æ™¶ï¼Œæå¤§æå‡æš´å‡»é˜²å¾¡', statType: 'critDef', statValue: 12, requiredLevel: 55, type: 'stat' }
        ];

        // æ¸¸æˆçŠ¶æ€
        let level = 1;
        let currentExp = 0;
        let nextLevelExp = 100;
        let currentSceneId = 0; // å½“å‰åœºæ™¯ID
        let currentExpRate = scenes[0].expRate; // å½“å‰ç»éªŒè·å–é€Ÿç‡
        const clickExpGain = 10; // ç‚¹å‡»æŒ‰é’®è·å¾—çš„ç»éªŒ
        let backpack = new Array(25).fill(null); // èƒŒåŒ…ï¼š25ä¸ªæ ¼å­
        let unlockedSlots = 5; // å·²è§£é”çš„æ ¼å­æ•°é‡

        // ç©å®¶å±æ€§ç³»ç»Ÿ
        const playerAttributes = {
            health: { base: 100, growth: 10, icon: 'â¤ï¸', name: 'ç”Ÿå‘½' },
            mana: { base: 50, growth: 5, icon: 'ğŸ’™', name: 'å†…åŠ›' },
            attack: { base: 10, growth: 2, icon: 'âš”ï¸', name: 'æ”»å‡»' },
            defense: { base: 5, growth: 1, icon: 'ğŸ›¡ï¸', name: 'é˜²å¾¡' },
            accuracy: { base: 80, growth: 3, icon: 'ğŸ¯', name: 'å‘½ä¸­' },
            evasion: { base: 20, growth: 2, icon: 'ğŸ’¨', name: 'é—ªé¿' },
            crit: { base: 5, growth: 1, icon: 'âš¡', name: 'æš´å‡»' },
            critDef: { base: 3, growth: 1, icon: 'ğŸ›¡ï¸', name: 'æš´å‡»é˜²å¾¡' }
        };

        // è®¡ç®—å±æ€§å€¼
        function calculateAttribute(attributeName) {
            const attr = playerAttributes[attributeName];
            return attr.base + (level - 1) * attr.growth;
        }

        // è·å–æ‰€æœ‰å±æ€§å€¼
        function getAllAttributes() {
            const attributes = {};
            for (const key in playerAttributes) {
                attributes[key] = calculateAttribute(key);
            }
            return attributes;
        }

        // DOM å…ƒç´ 
        const levelEl = document.getElementById('level');
        const currentExpEl = document.getElementById('current-exp');
        const nextLevelExpEl = document.getElementById('next-level-exp');
        const progressFill = document.getElementById('progress-fill');
        const expRateEl = document.getElementById('exp-rate');
        const gainExpBtn = document.getElementById('gain-exp-btn');
        const levelUpBtn = document.getElementById('level-up-btn');
        const resetBtn = document.getElementById('reset-btn');
        const sceneSwitchBtn = document.getElementById('scene-switch-btn');
        const scenePanel = document.getElementById('scene-panel');
        const closeSceneBtn = document.getElementById('close-scene-btn');
        const sceneList = document.getElementById('scene-list');
        const currentSceneEmojiEl = document.getElementById('current-scene-emoji');
        const currentSceneNameEl = document.getElementById('current-scene-name');
        const avatarEl = document.querySelector('.avatar');
        const backpackBtn = document.getElementById('backpack-btn');
        const backpackPanel = document.getElementById('backpack-panel');
        const closeBackpackBtn = document.getElementById('close-backpack-btn');
        const backpackGrid = document.getElementById('backpack-grid');
        const attributesBtn = document.getElementById('attributes-btn');
        const attributesPanel = document.getElementById('attributes-panel');
        const closeAttributesBtn = document.getElementById('close-attributes-btn');
        const attributesGrid = document.getElementById('attributes-grid');

        // æ›´æ–°æ˜¾ç¤º
        function updateDisplay() {
            levelEl.textContent = level;
            currentExpEl.textContent = Math.floor(currentExp);
            nextLevelExpEl.textContent = nextLevelExp;

            // æ›´æ–°è¿›åº¦æ¡
            const progress = (currentExp / nextLevelExp) * 100;
            progressFill.style.width = `${progress}%`;

            // æ›´æ–°å‡çº§æŒ‰é’®çŠ¶æ€
            levelUpBtn.disabled = currentExp < nextLevelExp;

            // æ›´æ–°åœºæ™¯åˆ‡æ¢æŒ‰é’®çŠ¶æ€ï¼ˆ5çº§è§£é”ï¼‰
            sceneSwitchBtn.disabled = level < 5;

            // æ›´æ–°èƒŒåŒ…æŒ‰é’®çŠ¶æ€ï¼ˆ3çº§è§£é”ï¼‰
            backpackBtn.disabled = level < 3;

            // æ›´æ–°å±æ€§æŒ‰é’®çŠ¶æ€ï¼ˆ9çº§è§£é”ï¼‰
            attributesBtn.disabled = level < 9;

            // æ›´æ–°ç»éªŒé€Ÿç‡æ˜¾ç¤º
            expRateEl.textContent = currentExpRate;
        }

        // è®¡ç®—å‡çº§æ‰€éœ€ç»éªŒ
        function getNextLevelExp(lvl) {
            return Math.floor(100 * Math.pow(1.2, lvl - 1));
        }

        // å‡çº§
        function levelUp() {
            const oldUnlockedSlots = unlockedSlots;
            level++;
            currentExp = currentExp - nextLevelExp;
            nextLevelExp = getNextLevelExp(level);

            // é‡æ–°è®¡ç®—è§£é”çš„æ ¼å­æ•°
            unlockedSlots = calculateUnlockedSlots();

            // æ£€æŸ¥æ˜¯å¦è§£é”äº†æ–°çš„æ ¼å­
            if (unlockedSlots > oldUnlockedSlots) {
                showSlotUnlockNotification(unlockedSlots);
            }

            // æ˜¾ç¤ºå‡çº§é€šçŸ¥
            showLevelUpNotification();

            // æ’­æ”¾å‡çº§åŠ¨ç”»æ•ˆæœ
            levelEl.style.animation = 'none';
            levelEl.offsetHeight; // è§¦å‘é‡æ’
            levelEl.style.animation = 'bounce 0.5s ease 3';
        }

        // æ˜¾ç¤ºå‡çº§é€šçŸ¥
        function showLevelUpNotification() {
            const notification = document.createElement('div');
            notification.className = 'level-up-notification';
            notification.textContent = `ğŸ‰ å‡çº§äº†ï¼ç°åœ¨æ˜¯ Lv.${level}ï¼`;
            notification.style.top = '80px'; // æ”¹ä¸ºä»é¡¶éƒ¨80pxå¼€å§‹
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 2500);
        }

        // æ˜¾ç¤ºç»éªŒè·å¾—æ•ˆæœ
        function showExpGain(amount, x, y) {
            const expGain = document.createElement('div');
            expGain.className = 'exp-gain';
            expGain.textContent = `+${amount}`;
            expGain.style.left = `${x}px`;
            expGain.style.top = `${y}px`;
            document.body.appendChild(expGain);

            setTimeout(() => {
                expGain.remove();
            }, 1000);
        }

        // æ˜¾ç¤ºç»éªŒä¸è¶³é€šçŸ¥
        function showInsufficientExpNotification() {
            const notification = document.createElement('div');
            notification.className = 'insufficient-exp-notification';
            notification.textContent = `âŒ ç»éªŒä¸è¶³ï¼è¿˜éœ€è¦ ${nextLevelExp - currentExp} ç»éªŒ`;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 2000);
        }

        // å¢åŠ ç»éªŒ
        function addExp(amount) {
            currentExp += amount;
            updateDisplay();
        }

        // æ£€æµ‹æ‰è½
        function checkForDrop(sceneId) {
            const drops = sceneDrops[sceneId];
            if (!drops) return;

            for (const drop of drops) {
                if (Math.random() < drop.probability) {
                    const item = itemTypes.find(item => item.id === drop.itemId);
                    if (item) {
                        addToBackpack(item);
                        return item;
                    }
                }
            }
            return null;
        }

        // æ·»åŠ ç‰©å“åˆ°èƒŒåŒ…
        function addToBackpack(item) {
            // æŸ¥æ‰¾æ˜¯å¦å·²æœ‰ç›¸åŒç‰©å“
            let existingSlot = -1;
            for (let i = 0; i < unlockedSlots; i++) {
                if (backpack[i] && backpack[i].id === item.id) {
                    existingSlot = i;
                    break;
                }
            }

            if (existingSlot >= 0) {
                // å †å åˆ°å·²æœ‰ç‰©å“
                backpack[existingSlot].count++;
            } else {
                // å¯»æ‰¾ç©ºæ ¼å­
                let emptySlot = -1;
                for (let i = 0; i < unlockedSlots; i++) {
                    if (!backpack[i]) {
                        emptySlot = i;
                        break;
                    }
                }

                if (emptySlot >= 0) {
                    // æ·»åŠ åˆ°ç©ºæ ¼å­
                    backpack[emptySlot] = {
                        ...item,
                        count: 1
                    };
                } else {
                    // èƒŒåŒ…æ»¡äº†
                    showBackpackFullNotification();
                    return false;
                }
            }

            return true;
        }

        // æ˜¾ç¤ºæ‰è½åŠ¨ç”»
        function showDropAnimation(item, backpackRect) {
            const avatarEl = document.querySelector('.avatar');
            const avatarRect = avatarEl.getBoundingClientRect();

            const dropAnim = document.createElement('div');
            dropAnim.className = 'item-drop-animation';
            dropAnim.textContent = item.emoji;
            dropAnim.style.left = avatarRect.left + avatarRect.width / 2 + 'px';
            dropAnim.style.top = avatarRect.top + avatarRect.height / 2 + 'px';

            // è®¡ç®—ä¸­é—´ç‚¹å’Œç›®æ ‡ç‚¹ï¼Œè®©åŠ¨ç”»ä»è§’è‰²åˆ°å³ä¸Šè§’ï¼Œé¿å…é®æŒ¡ä¸­å¿ƒåŒºåŸŸ
            const gameContainer = document.querySelector('.game-container');
            const containerRect = gameContainer.getBoundingClientRect();

            // ç›®æ ‡ç‚¹æ”¹ä¸ºæ¸¸æˆå®¹å™¨å³ä¸Šè§’åŒºåŸŸ
            const targetX = containerRect.right - 100 - avatarRect.left - avatarRect.width / 2;
            const targetY = containerRect.top + 50 - avatarRect.top - avatarRect.height / 2;

            // ä¸­é—´ç‚¹ç¨å¾®åç§»ï¼Œå½¢æˆå¼§å½¢
            const midX = targetX / 2;
            const midY = (targetY - 100) / 2;

            dropAnim.style.setProperty('--mid-x', midX + 'px');
            dropAnim.style.setProperty('--mid-y', midY + 'px');
            dropAnim.style.setProperty('--target-x', targetX + 'px');
            dropAnim.style.setProperty('--target-y', targetY + 'px');

            document.body.appendChild(dropAnim);

            setTimeout(() => {
                dropAnim.remove();
            }, 1500);
        }

        // æ˜¾ç¤ºæ‰è½é€šçŸ¥
        function showDropNotification(item) {
            const notification = document.createElement('div');
            notification.className = 'drop-notification';
            notification.textContent = `ğŸ‰ è·å¾—äº† ${item.emoji} ${item.name}ï¼`;
            notification.style.top = '180px'; // æ”¾åœ¨æ›´ä¸‹æ–¹ï¼Œä¸æŒ¡ä½åœºæ™¯ä¿¡æ¯
            notification.style.transform = 'translate(-50%, -50%)'; // ä¿æŒå±…ä¸­
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 2000);
        }

        // æ˜¾ç¤ºèƒŒåŒ…æ»¡é€šçŸ¥
        function showBackpackFullNotification() {
            const notification = document.createElement('div');
            notification.className = 'backpack-full-notification';
            notification.textContent = 'ğŸ”’ èƒŒåŒ…å·²æ»¡ï¼Œæ— æ³•è·å¾—æ›´å¤šç‰©å“ï¼';
            notification.style.top = '220px'; // æ”¾åœ¨æ‰è½é€šçŸ¥ä¸‹æ–¹
            notification.style.transform = 'translate(-50%, -50%)'; // ä¿æŒå±…ä¸­
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 2000);
        }

        // è‡ªåŠ¨ç»éªŒå¢é•¿
        setInterval(() => {
            addExp(currentExpRate);

            // æ£€æµ‹æ‰è½
            const droppedItem = checkForDrop(currentSceneId);
            if (droppedItem) {
                const backpackRect = backpackBtn.getBoundingClientRect();
                showDropAnimation(droppedItem, backpackRect);
                showDropNotification(droppedItem);
                renderBackpack();
            }
        }, 1000); // æ¯ç§’å¢åŠ  currentExpRate ç‚¹ç»éªŒ

        // æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        gainExpBtn.addEventListener('click', (e) => {
            const rect = gainExpBtn.getBoundingClientRect();
            const x = e.clientX;
            const y = e.clientY;

            addExp(clickExpGain);
            showExpGain(clickExpGain, x, y);
        });

        // å‡çº§æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        levelUpBtn.addEventListener('click', () => {
            if (currentExp >= nextLevelExp) {
                levelUp();
            } else {
                showInsufficientExpNotification();
            }
        });

        // è®¡ç®—è§£é”çš„æ ¼å­æ•°é‡
        function calculateUnlockedSlots() {
            // åˆå§‹5ä¸ªæ ¼å­ï¼Œæ¯3çº§è§£é”1ä¸ªï¼Œæœ€å¤š25ä¸ª
            const baseSlots = 5;
            const slotsPerLevel = 3;
            return Math.min(25, baseSlots + Math.floor((level - 1) / slotsPerLevel));
        }

        // åˆå§‹åŒ–èƒŒåŒ…ç‰©å“
        function initializeBackpack() {
            backpack = new Array(25).fill(null);

            // èƒŒåŒ…åˆå§‹ä¸ºç©ºï¼Œç‰©å“é€šè¿‡æ‰è½è·å¾—

            // è®¡ç®—å·²è§£é”çš„æ ¼å­æ•°
            unlockedSlots = calculateUnlockedSlots();
        }

        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            level = 1;
            currentExp = 0;
            nextLevelExp = 100;
            currentSceneId = 0;
            currentExpRate = scenes[0].expRate;
            initializeBackpack();
            updateSceneDisplay();
            updateDisplay();
        }

        // æ¸²æŸ“èƒŒåŒ…
        function renderBackpack() {
            backpackGrid.innerHTML = '';

            backpack.forEach((item, index) => {
                const slot = document.createElement('div');

                // æ£€æŸ¥æ ¼å­æ˜¯å¦å·²è§£é”
                if (index < unlockedSlots) {
                    slot.className = 'backpack-slot';

                    if (item) {
                        slot.classList.add('clickable');
                        slot.textContent = item.emoji;
                        if (item.count > 1) {
                            const countBadge = document.createElement('div');
                            countBadge.className = 'item-count';
                            countBadge.textContent = item.count;
                            slot.appendChild(countBadge);
                        }

                        // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                        slot.addEventListener('click', () => useItem(index));

                        // æ·»åŠ é¼ æ ‡æ‚¬åœäº‹ä»¶
                        slot.addEventListener('mouseenter', (e) => showItemTooltip(e, item));
                        slot.addEventListener('mouseleave', hideItemTooltip);
                        slot.addEventListener('mousemove', moveItemTooltip);
                    } else {
                        slot.classList.add('empty');
                        slot.textContent = 'â—‹';
                    }
                } else {
                    // é”å®šçš„æ ¼å­
                    slot.className = 'backpack-slot locked';
                    const unlockLevel = 5 + index * 3; // è®¡ç®—è§£é”ç­‰çº§
                    const unlockText = document.createElement('div');
                    unlockText.className = 'unlock-level';
                    unlockText.textContent = unlockLevel;
                    slot.appendChild(unlockText);
                }

                backpackGrid.appendChild(slot);
            });
        }

        // æ‰“å¼€èƒŒåŒ…
        function openBackpack() {
            if (level < 3) {
                showLockedNotification('èƒŒåŒ…åŠŸèƒ½éœ€è¦è¾¾åˆ° 3 çº§æ‰èƒ½è§£é”ï¼');
                return;
            }
            renderBackpack();
            backpackPanel.classList.add('active');
        }

        // å…³é—­èƒŒåŒ…
        function closeBackpack() {
            backpackPanel.classList.remove('active');
        }

        // æ˜¾ç¤ºç­‰çº§ä¸è¶³æç¤º
        function showLevelRequirementNotification() {
            const notification = document.createElement('div');
            notification.className = 'locked-notification';
            notification.textContent = `ğŸ”’ ç©å®¶ç­‰çº§æœªè¾¾åˆ°ç‰©å“éœ€è¦ç­‰çº§ï¼`;
            notification.style.background = 'linear-gradient(135deg, #ff9800 0%, #f57c00 100%)';
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 2000);
        }

        // æ˜¾ç¤ºæ ¼å­è§£é”é€šçŸ¥
        function showSlotUnlockNotification(slotsCount) {
            const notification = document.createElement('div');
            notification.className = 'level-up-notification';
            notification.textContent = `ğŸ‰ è§£é”äº†æ–°çš„èƒŒåŒ…æ ¼å­ï¼ç°åœ¨æ˜¯ ${slotsCount} ä¸ªæ ¼å­ï¼`;
            notification.style.background = 'linear-gradient(135deg, #4CAF50 0%, #45a049 100%)';
            notification.style.top = '140px'; // æ”¾åœ¨å‡çº§æ¶ˆæ¯ä¸‹æ–¹
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 2500);
        }

        // æ¸²æŸ“å±æ€§é¢æ¿
        function renderAttributesPanel() {
            attributesGrid.innerHTML = '';
            const attributes = getAllAttributes();

            for (const [key, attr] of Object.entries(playerAttributes)) {
                const attributeValue = attributes[key];
                const attrItem = document.createElement('div');
                attrItem.className = `attribute-item attribute-${key}`;

                attrItem.innerHTML = `
                    <div class="attribute-name">
                        <span class="attribute-icon">${attr.icon}</span>
                        ${attr.name}
                    </div>
                    <div class="attribute-value">${attributeValue}</div>
                    <div class="attribute-growth">æ¯çº§ +${attr.growth}</div>
                `;

                attributesGrid.appendChild(attrItem);
            }
        }

        // æ‰“å¼€å±æ€§é¢æ¿
        function openAttributesPanel() {
            if (level < 9) {
                showLockedNotification('å±æ€§é¢æ¿éœ€è¦è¾¾åˆ° 9 çº§æ‰èƒ½è§£é”ï¼');
                return;
            }
            renderAttributesPanel();
            attributesPanel.classList.add('active');
        }

        // å…³é—­å±æ€§é¢æ¿
        function closeAttributesPanel() {
            attributesPanel.classList.remove('active');
        }

        // ä½¿ç”¨ç‰©å“
        function useItem(index) {
            const item = backpack[index];
            if (!item) return;

            // æ£€æŸ¥ç©å®¶ç­‰çº§æ˜¯å¦è¾¾åˆ°ç‰©å“è¦æ±‚
            if (level < item.requiredLevel) {
                showLevelRequirementNotification();
                return;
            }

            if (item.type === 'exp') {
                // ç»éªŒç‰©å“
                addExp(item.expValue);

                // æ˜¾ç¤ºç»éªŒè·å¾—æ•ˆæœï¼ˆåœ¨èƒŒåŒ…æŒ‰é’®ä½ç½®ï¼‰
                const rect = backpackBtn.getBoundingClientRect();
                showExpGain(item.expValue, rect.right + 10, rect.top);

            } else if (item.type === 'stat') {
                // å±æ€§ç‰©å“
                applyStatBonus(item);

                // æ˜¾ç¤ºå±æ€§æå‡é€šçŸ¥
                showStatBonusNotification(item);
            }

            // å‡å°‘ç‰©å“æ•°é‡
            item.count--;
            if (item.count <= 0) {
                backpack[index] = null;
            }

            // éšè—æ‰€æœ‰Tips
            hideItemTooltip();

            // é‡æ–°æ¸²æŸ“èƒŒåŒ…
            renderBackpack();
        }

        // åº”ç”¨å±æ€§åŠ æˆ
        function applyStatBonus(item) {
            if (item.statType && item.statValue) {
                // åœ¨è¿™é‡Œæ°¸ä¹…å¢åŠ å±æ€§
                // ç”±äºæˆ‘ä»¬çš„å±æ€§ç³»ç»Ÿæ˜¯åŸºäºç­‰çº§è®¡ç®—çš„ï¼Œè¿™é‡Œå¯ä»¥å­˜å‚¨ä¸€ä¸ªåŠ æˆå€¼
                // ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬æš‚æ—¶æ˜¾ç¤ºä¸€ä¸ªæç¤º
                console.log(`å¢åŠ äº† ${item.statValue} ç‚¹ ${item.statType} å±æ€§`);
            }
        }

        // æ˜¾ç¤ºå±æ€§æå‡é€šçŸ¥
        function showStatBonusNotification(item) {
            const notification = document.createElement('div');
            notification.className = 'drop-notification';
            notification.textContent = `ğŸ‰ æ°¸ä¹…æå‡äº† ${item.statValue} ç‚¹ ${getAttributeName(item.statType)}ï¼`;
            notification.style.top = '260px'; // æ”¾åœ¨èƒŒåŒ…æ»¡æ¶ˆæ¯ä¸‹æ–¹
            notification.style.transform = 'translate(-50%, -50%)';
            notification.style.background = 'linear-gradient(135deg, #9c27b0 0%, #673ab7 100%)';
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 2000);
        }

        // è·å–å±æ€§ä¸­æ–‡å
        function getAttributeName(statType) {
            const attributeNames = {
                health: 'ç”Ÿå‘½',
                mana: 'å†…åŠ›',
                attack: 'æ”»å‡»',
                defense: 'é˜²å¾¡',
                accuracy: 'å‘½ä¸­',
                evasion: 'é—ªé¿',
                crit: 'æš´å‡»',
                critDef: 'æš´å‡»é˜²å¾¡'
            };
            return attributeNames[statType] || statType;
        }

        // æ˜¾ç¤ºç‰©å“æç¤º
        let tooltip = null;

        function showItemTooltip(e, item) {
            tooltip = document.createElement('div');
            tooltip.className = 'item-tooltip';

            // æ£€æŸ¥ç©å®¶ç­‰çº§æ˜¯å¦æ»¡è¶³è¦æ±‚
            const levelCheck = level >= item.requiredLevel;
            const levelColor = levelCheck ? '#4CAF50' : '#ff6b6b';

            let effectHtml = '';
            if (item.type === 'exp') {
                effectHtml = `<div class="item-effect">æ•ˆæœï¼š+${item.expValue} ç»éªŒ</div>`;
            } else if (item.type === 'stat') {
                effectHtml = `<div class="item-effect" style="color: #9c27b0;">æ°¸ä¹…æå‡ï¼š+${item.statValue} ${getAttributeName(item.statType)}</div>`;
            }

            tooltip.innerHTML = `
                <div class="item-name">${item.name}</div>
                <div class="item-description">${item.description}</div>
                ${effectHtml}
                <div class="item-level" style="color: ${levelColor}; margin-top: 3px;">
                    ${levelCheck ? 'âœ“' : 'âœ—'} éœ€è¦ Lv.${item.requiredLevel}
                </div>
            `;
            document.body.appendChild(tooltip);
            moveItemTooltip(e);
        }

        function moveItemTooltip(e) {
            if (!tooltip) return;
            tooltip.style.left = (e.clientX + 10) + 'px';
            tooltip.style.top = (e.clientY - 10) + 'px';
        }

        function hideItemTooltip() {
            if (tooltip) {
                tooltip.remove();
                tooltip = null;
            }
        }

        // åˆ‡æ¢åœºæ™¯
        function switchScene(sceneId) {
            const scene = scenes[sceneId];
            if (!scene || level < scene.unlockLevel) {
                return;
            }

            currentSceneId = sceneId;
            currentExpRate = scene.expRate;
            updateSceneDisplay();
            updateDisplay();
            renderSceneList();
            closeScenePanel();
        }

        // æ›´æ–°åœºæ™¯æ˜¾ç¤º
        function updateSceneDisplay() {
            const scene = scenes[currentSceneId];
            currentSceneEmojiEl.textContent = scene.emoji;
            currentSceneNameEl.textContent = scene.name;
            avatarEl.textContent = scene.emoji;
        }

        // æ¸²æŸ“åœºæ™¯åˆ—è¡¨
        function renderSceneList() {
            sceneList.innerHTML = '';

            scenes.forEach(scene => {
                const sceneItem = document.createElement('div');
                sceneItem.className = 'scene-item';

                const isLocked = level < scene.unlockLevel;
                const isActive = scene.id === currentSceneId;

                if (isLocked) {
                    sceneItem.classList.add('locked');
                }
                if (isActive) {
                    sceneItem.classList.add('active');
                }

                let dropInfo = '';
                if (!isLocked) {
                    const drops = sceneDrops[scene.id];
                    if (drops && drops.length > 0) {
                        const dropNames = drops.map(drop => {
                            const item = itemTypes.find(item => item.id === drop.itemId);
                            return item ? item.emoji : '';
                        }).filter(emoji => emoji).join(' ');
                        if (dropNames) {
                            dropInfo = `<div style="font-size: 10px; margin-top: 5px;">æ‰è½: ${dropNames}</div>`;
                        }
                    }
                }

                sceneItem.innerHTML = `
                    <div class="scene-emoji">${isLocked ? 'ğŸ”’' : scene.emoji}</div>
                    <div class="scene-name">${isLocked ? '???' : scene.name}</div>
                    <div class="scene-rate">${isLocked ? '' : scene.expRate + ' ç»éªŒ/ç§’'}</div>
                    ${dropInfo}
                    ${isLocked ? `<div class="scene-unlock-badge">Lv.${scene.unlockLevel}</div>` : ''}
                `;

                if (!isLocked) {
                    sceneItem.addEventListener('click', () => switchScene(scene.id));
                }

                sceneList.appendChild(sceneItem);
            });
        }

        // æ‰“å¼€åœºæ™¯é¢æ¿
        function openScenePanel() {
            if (level < 5) {
                showLockedNotification('åœºæ™¯åˆ‡æ¢åŠŸèƒ½éœ€è¦è¾¾åˆ° 5 çº§æ‰èƒ½è§£é”ï¼');
                return;
            }
            renderSceneList();
            scenePanel.classList.add('active');
        }

        // å…³é—­åœºæ™¯é¢æ¿
        function closeScenePanel() {
            scenePanel.classList.remove('active');
        }

        // æ˜¾ç¤ºåŠŸèƒ½é”å®šé€šçŸ¥
        function showLockedNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'locked-notification';
            notification.textContent = `ğŸ”’ ${message}`;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 2000);
        }

        // é‡ç½®æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        resetBtn.addEventListener('click', resetGame);

        // åœºæ™¯åˆ‡æ¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        sceneSwitchBtn.addEventListener('click', openScenePanel);

        // èƒŒåŒ…æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        backpackBtn.addEventListener('click', openBackpack);

        // å±æ€§æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        attributesBtn.addEventListener('click', openAttributesPanel);

        // å…³é—­èƒŒåŒ…æŒ‰é’®
        closeBackpackBtn.addEventListener('click', closeBackpack);

        // å…³é—­å±æ€§é¢æ¿æŒ‰é’®
        closeAttributesBtn.addEventListener('click', closeAttributesPanel);

        // ç‚¹å‡»èƒŒåŒ…é¢æ¿å¤–éƒ¨å…³é—­
        backpackPanel.addEventListener('click', (e) => {
            if (e.target === backpackPanel) {
                closeBackpack();
            }
        });

        // ç‚¹å‡»å±æ€§é¢æ¿å¤–éƒ¨å…³é—­
        attributesPanel.addEventListener('click', (e) => {
            if (e.target === attributesPanel) {
                closeAttributesPanel();
            }
        });

        // å…³é—­åœºæ™¯é¢æ¿æŒ‰é’®
        closeSceneBtn.addEventListener('click', closeScenePanel);

        // ç‚¹å‡»åœºæ™¯é¢æ¿å¤–éƒ¨å…³é—­
        scenePanel.addEventListener('click', (e) => {
            if (e.target === scenePanel) {
                closeScenePanel();
            }
        });

        // åˆå§‹åŒ–æ˜¾ç¤º
        initializeBackpack();
        updateSceneDisplay();
        updateDisplay();
    </script>
</body>
</html>
